{% extends 'layouts/app_layout.html' %}

{% block title %}Configuración de Alertas de Lotes{% endblock %}

{% block app_content %}
<div class="btn-toolbar">
    <a href="#" onclick="history.back();" class="btn btn-outline-secondary me-2" title="Volver a la página anterior">
        <i class="bi bi-arrow-left"></i> Volver
    </a>
</div>
<div class="container-fluid px-4">
    <h1 class="mt-4">Umbral de Vencimiento de Lotes</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item active">Vencimiento de Lotes de insumo y producto</li>
    </ol>
    
    <div class="card mb-4">
        <div class="card-header">
            <i class="fas fa-calendar-times me-1"></i>
            Configurar Umbral de Vencimiento
        </div>
        <div class="card-body">
            {% if 'configurar_alertas' is has_permission %}
            <form action="{{ url_for('alertas.configurar_alertas_lotes') }}" method="POST">
                {{ csrf_form.csrf_token }}
                <div class="mb-3">
                    <label for="dias_vencimiento" class="form-label">Días de antelación para alerta de vencimiento</label>
                    <input type="number" min="0" max="30" class="form-control" id="dias_vencimiento" name="dias_vencimiento" value="{{ dias_vencimiento }}" required>
                    <div class="form-text">
                        Esta configuración determina cuántos días antes de la fecha de vencimiento de un lote se generará una alerta.
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Guardar Configuración</button>
            </form>
            {% else %}
            <div class="alert alert-warning">
                No tiene permisos para modificar esta configuración. El umbral actual es de <strong>{{ dias_vencimiento }} días</strong>.
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
