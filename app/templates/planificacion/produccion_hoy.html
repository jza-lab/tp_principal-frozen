{% extends 'layouts/app_layout.html' %}

{% block title %}Tablero Kanban - Operario{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/planificacion/produccion_hoy.css">
{% endblock %}

{% block app_content %}
    <div class="container">
        <!-- Header con info del operario -->
        <div class="header">
            <div class="operator-info">
                <div class="operator-avatar">JM</div>
                <div class="operator-details">
                    <h2>Juan Mart√≠nez</h2>
                    <p>Operario - L√≠nea 1 | Turno Ma√±ana</p>
                </div>
                <div class="shift-badge">üïê Turno: 08:00 - 16:00</div>
            </div>
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value">3</div>
                    <div class="stat-label">Mis √ìrdenes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">1</div>
                    <div class="stat-label">En Proceso</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">8</div>
                    <div class="stat-label">Completadas Hoy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">95%</div>
                    <div class="stat-label">Eficiencia</div>
                </div>
            </div>
        </div>

        <!-- Filtros r√°pidos -->
        <div class="quick-filters">
            <span class="filter-label">üîç Filtrar:</span>
            <button class="filter-btn active">Todas</button>
            <button class="filter-btn">Mis √ìrdenes</button>
            <button class="filter-btn">L√≠nea 1</button>
            <button class="filter-btn">L√≠nea 2</button>
            <button class="filter-btn">Alta Prioridad</button>
        </div>

        <!-- Tablero Kanban -->
        <div class="kanban-board">
            <!-- Columna: En Espera -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">En Espera</div>
                    <div class="column-count">2</div>
                </div>
                <div class="column-body">
                    <div class="order-card priority-low">
                        <div class="card-header">
                            <div class="product-name">√ëoquis de papa congelados</div>
                            <span class="priority-badge badge-low">Baja</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251030170630844
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">15.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2025-11-01</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üè≠</span>
                                <span class="detail-label">L√≠nea:</span>
                                <span class="detail-value">L1 - Sin asignar</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-card priority-medium">
                        <div class="card-header">
                            <div class="product-name">Empanadas de carne congeladas</div>
                            <span class="priority-badge badge-medium">Media</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251031201305996
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">5000.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2026-09-11</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üè≠</span>
                                <span class="detail-label">L√≠nea:</span>
                                <span class="detail-value">Sin asignar</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna: Lista para producir -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">Lista para producir</div>
                    <div class="column-count">3</div>
                </div>
                <div class="column-body">
                    <div class="order-card priority-high">
                        <div class="card-header">
                            <div class="product-name">Hamburguesas de lentejas congeladas</div>
                            <span class="priority-badge badge-high">Alta</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251030170141762
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">40.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üè≠</span>
                                <span class="detail-label">L√≠nea Sugerida:</span>
                                <span class="detail-value">L√≠nea 1</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2025-11-01</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">‚è±Ô∏è</span>
                                <span class="detail-label">Tiempo Est.:</span>
                                <span class="detail-value">2h 15min</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="startOrder(this)">
                                ‚ñ∂Ô∏è Iniciar
                            </button>
                        </div>
                    </div>

                    <div class="order-card priority-medium">
                        <div class="card-header">
                            <div class="product-name">Empanadas de carne congeladas</div>
                            <span class="priority-badge badge-medium">Media</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251031160916214
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">82.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üè≠</span>
                                <span class="detail-label">L√≠nea Sugerida:</span>
                                <span class="detail-value">L√≠nea 1</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2025-11-01</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">‚è±Ô∏è</span>
                                <span class="detail-label">Tiempo Est.:</span>
                                <span class="detail-value">4h 30min</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="startOrder(this)">
                                ‚ñ∂Ô∏è Iniciar
                            </button>
                        </div>
                    </div>

                    <div class="order-card priority-medium">
                        <div class="card-header">
                            <div class="product-name">Tarta de jam√≥n y queso congelada</div>
                            <span class="priority-badge badge-medium">Media</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251030170630547
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">20.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üè≠</span>
                                <span class="detail-label">L√≠nea Sugerida:</span>
                                <span class="detail-value">L√≠nea 2</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2025-11-01</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">‚è±Ô∏è</span>
                                <span class="detail-label">Tiempo Est.:</span>
                                <span class="detail-value">1h 45min</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="startOrder(this)">
                                ‚ñ∂Ô∏è Iniciar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna: L√≠nea 1 -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">L√≠nea 1</div>
                    <div class="column-count">1</div>
                </div>
                <div class="column-body">
                    <div class="order-card priority-high">
                        <div class="card-header">
                            <div class="product-name">Milanesas de pollo congeladas</div>
                            <span class="priority-badge badge-high">En Proceso</span>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251030171015817
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Progreso:</span>
                                <span class="detail-value">2.5 / 5.0 kg (50%)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üë§</span>
                                <span class="detail-label">Operario:</span>
                                <span class="detail-value">Juan M. (T√∫)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìÖ</span>
                                <span class="detail-label">Inicio:</span>
                                <span class="detail-value">2025-10-31</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 50%"></div>
                        </div>
                        <div class="active-timer">
                            <div class="timer-pulse"></div>
                            <span class="timer-text">‚è±Ô∏è 01:23:45 trabajando</span>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-pause" onclick="pauseOrder()">
                                ‚è∏Ô∏è Pausar
                            </button>
                            <button class="btn btn-complete" onclick="reportProgress()">
                                ‚úÖ Reportar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna: L√≠nea 2 -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">L√≠nea 2</div>
                    <div class="column-count">0</div>
                </div>
                <div class="column-body">
                    <div class="empty-state">
                        <div class="empty-icon">üì≠</div>
                        <div class="empty-text">Sin √≥rdenes en proceso</div>
                    </div>
                </div>
            </div>

            <!-- Columna: Empaquetado -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">Empaquetado</div>
                    <div class="column-count">0</div>
                </div>
                <div class="column-body">
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <div class="empty-text">Sin √≥rdenes para empaquetar</div>
                    </div>
                </div>
            </div>

            <!-- Columna: Control de Calidad -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">Control de Calidad</div>
                    <div class="column-count">0</div>
                </div>
                <div class="column-body">
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <div class="empty-text">Sin √≥rdenes en revisi√≥n</div>
                    </div>
                </div>
            </div>

            <!-- Columna: Completada -->
            <div class="kanban-column">
                <div class="column-header">
                    <div class="column-title">Completada</div>
                    <div class="column-count">2</div>
                </div>
                <div class="column-body">
                    <div class="order-card">
                        <div class="card-header">
                            <div class="product-name">Milanesas de pollo congeladas</div>
                        </div>
                        <div class="order-code">
                            üì¶ OP-20251030171420311
                        </div>
                        <div class="card-details">
                            <div class="detail-row">
                                <span class="detail-icon">‚úÖ</span>
                                <span class="detail-label">Completado:</span>
                                <span class="detail-value">14:30</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üìä</span>
                                <span class="detail-label">Cantidad:</span>
                                <span class="detail-value">50.0 kg</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-icon">üë§</span>
                                <span class="detail-label">Operario:</span>
                                <span class="detail-value">Juan M.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Reportar Avance -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üìä Reportar Avance de Producci√≥n</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Cantidad Producida (Buena) *</label>
                    <input type="number" class="form-input" placeholder="Ej: 40.0" value="2.5">
                </div>
                <div class="form-group">
                    <label class="form-label">Cantidad Desperdicio (Mala)</label>
                    <input type="number" class="form-input" placeholder="Ej: 2.0" value="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Motivo de Desperdicio (si aplica)</label>
                    <select class="form-select">
                        <option>Sin desperdicio</option>
                        <option>Falla de empaque</option>
                        <option>Materia prima defectuosa</option>
                        <option>Error de temperatura</option>
                        <option>Error de proceso</option>
                        <option>Contaminaci√≥n cruzada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Observaciones adicionales</label>
                    <textarea class="form-input" rows="3"
                        placeholder="Comentarios opcionales sobre el proceso..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                <button class="btn btn-complete" onclick="submitReport()">‚úÖ Confirmar Reporte</button>
            </div>
        </div>
    </div>

    <!-- Modal: Pausar Orden -->
    <div class="modal" id="pauseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚è∏Ô∏è Pausar Orden de Producci√≥n</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Motivo de la pausa *</label>
                    <select class="form-select">
                        <option value="">Seleccionar motivo...</option>
                        <option>Aver√≠a de m√°quina</option>
                        <option>Mantenimiento programado</option>
                        <option>Espera de material/insumo</option>
                        <option>Espera de supervisor</option>
                        <option>Break/Almuerzo</option>
                        <option>Cambio de turno</option>
                        <option>Problema de calidad</option>
                        <option>Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Detalles adicionales</label>
                    <textarea class="form-input" rows="3" placeholder="Describe el motivo de la pausa..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                <button class="btn btn-pause" onclick="confirmPause()">‚è∏Ô∏è Confirmar Pausa</button>
            </div>
        </div>
    </div>

    <!-- Modal: Iniciar Orden -->
    <div class="modal" id="startModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ñ∂Ô∏è Iniciar Orden de Producci√≥n</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Confirmar l√≠nea de producci√≥n *</label>
                    <select class="form-select">
                        <option value="1" selected>L√≠nea 1</option>
                        <option value="2">L√≠nea 2</option>
                    </select>
                    <div class="info-text">
                        ‚ÑπÔ∏è La l√≠nea sugerida por el sistema es: <strong>L√≠nea 1</strong>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Verificaci√≥n de materiales</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="check1">
                            <label for="check1">Materias primas disponibles</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="check2">
                            <label for="check2">L√≠nea limpia y sanitizada</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="check3">
                            <label for="check3">Equipos funcionando correctamente</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmStart()">‚ñ∂Ô∏è Iniciar Trabajo</button>
            </div>
        </div>
    </div>

{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/planificacion/produccion_hoy.js') }}"></script>
{% endblock %}

</html>